{"version":3,"sources":["webpack:///webpack/bootstrap 3ecbfce0bac8e2624877","webpack:///./client/src/boot/index.js","webpack:///./client/src/bundles/bundle.js","webpack:///./client/src/state/readOneFileQuery.js","webpack:///./client/src/state/revertToFileVersionMutation.js","webpack:///external \"GraphQLTag\"","webpack:///external \"ReactApollo\"","webpack:///external \"Injector\""],"names":["window","document","addEventListener","Injector","transform","updater","component","readOneFileQuery","revertToFileVersionMutation","require","query","gql","config","options","recordId","limit","page","variables","offset","file_id","props","data","error","refetch","readOneVersionedFile","networkLoading","loading","ownProps","actions","versions","errors","graphQLErrors","map","graphQLError","message","goToPage","mutation","mutate","revertToVersion","id","fromVersion","fromStage","toStage","refetchQueries"],"mappings":"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","file":"js/bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./client/src/bundles/bundle.js\");\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 3ecbfce0bac8e2624877","/* global window */\nimport Injector from 'lib/Injector';\nimport readOneFileQuery from '../state/readOneFileQuery';\nimport revertToFileVersionMutation from '../state/revertToFileVersionMutation';\n\nwindow.document.addEventListener('DOMContentLoaded', () => {\n  // Register GraphQL operations with Injector as transformations\n  Injector.transform(\n    'File-history',\n    (updater) => {\n      updater.component(\n        'HistoryViewer',\n        readOneFileQuery,\n        'AssetHistoryViewer',\n      );\n    },\n  );\n\n  Injector.transform(\n    'File-history-revert',\n    (updater) => {\n      updater.component(\n        'HistoryViewerToolbar.VersionedAdmin.HistoryViewer.File.HistoryViewerVersionDetail',\n        revertToFileVersionMutation,\n        'FileRevertMutation',\n      );\n    },\n  );\n});\n\n\n\n// WEBPACK FOOTER //\n// ./client/src/boot/index.js","// Include any legacy Entwine wrappers\n\n// Include boot entrypoint\nrequire('boot');\n\n\n\n// WEBPACK FOOTER //\n// ./client/src/bundles/bundle.js","import { graphql } from 'react-apollo';\nimport gql from 'graphql-tag';\n\n// GraphQL query for retrieving the version history of a specific object. The results of\n// the query must be set to the \"versions\" prop on the component that this HOC is\n// applied to for binding implementation.\nconst query = gql`\nquery ReadHistoryViewerFile ($file_id: ID!, $limit: Int!, $offset: Int!) {\n  readOneVersionedFile(\n    Versioning: {\n      Mode: LATEST\n    },\n    ID: $file_id\n  ) {\n    ID\n    Versions (limit: $limit, offset: $offset) {\n      pageInfo {\n        totalCount\n      }\n      edges {\n        node {\n          Version\n          Author {\n            FirstName\n            Surname\n          }\n          Publisher {\n            FirstName\n            Surname\n          }\n          Published\n          LiveVersion\n          LatestDraftVersion\n          LastEdited\n        }\n      }\n    }\n  }\n}\n`;\n\nconst config = {\n  options({ recordId, limit, page }) {\n    return {\n      variables: {\n        limit,\n        offset: ((page || 1) - 1) * limit,\n        file_id: recordId,\n      },\n    };\n  },\n  props(\n    {\n      data: {\n        error,\n        refetch,\n        readOneVersionedFile,\n        loading: networkLoading,\n      },\n      ownProps: {\n        actions = {\n          versions: {},\n        },\n        limit,\n        recordId,\n      },\n    },\n  ) {\n    const versions = readOneVersionedFile || null;\n\n    const errors = error && error.graphQLErrors &&\n      error.graphQLErrors.map(graphQLError => graphQLError.message);\n\n    return {\n      loading: networkLoading || !versions,\n      versions,\n      graphQLErrors: errors,\n      actions: {\n        ...actions,\n        versions: {\n          ...versions,\n          goToPage(page) {\n            refetch({\n              offset: ((page || 1) - 1) * limit,\n              limit,\n              file_id: recordId,\n            });\n          },\n        },\n      },\n    };\n  },\n};\n\nexport { query, config };\n\nexport default graphql(query, config);\n\n\n\n// WEBPACK FOOTER //\n// ./client/src/state/readOneFileQuery.js","import { graphql } from 'react-apollo';\nimport gql from 'graphql-tag';\n\nconst mutation = gql`\nmutation revertFileToVersion($id:ID!, $fromStage:VersionedStage!, $toStage:VersionedStage!, $fromVersion:Int!) {\n  copyFileToStage(Input: {\n    ID: $id\n    FromVersion: $fromVersion\n    FromStage: $fromStage\n    ToStage: $toStage\n  }) {\n    ID\n  }\n}\n`;\n\nconst config = {\n  props: ({ mutate, ownProps: { actions } }) => {\n    const revertToVersion = (id, fromVersion, fromStage, toStage) => mutate({\n      variables: {\n        id,\n        fromVersion,\n        fromStage,\n        toStage,\n      },\n    });\n\n    return {\n      actions: {\n        ...actions,\n        revertToVersion,\n      },\n    };\n  },\n  options: {\n    // Refetch versions after mutation is completed\n    refetchQueries: ['ReadHistoryViewerFile'],\n  },\n};\n\nexport { mutation, config };\n\nexport default graphql(mutation, config);\n\n\n\n// WEBPACK FOOTER //\n// ./client/src/state/revertToFileVersionMutation.js","module.exports = GraphQLTag;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"GraphQLTag\"\n// module id = 0\n// module chunks = 0","module.exports = ReactApollo;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"ReactApollo\"\n// module id = 1\n// module chunks = 0","module.exports = Injector;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"Injector\"\n// module id = 2\n// module chunks = 0"],"sourceRoot":""}